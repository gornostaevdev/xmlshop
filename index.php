<?php$path = "/home/p42363/www/store.jazzed.ru/"; // Путь к главной директории$httppath = "http://store.jazzed.ru/";$file = $path ."database/products.xml"; // Файл с новостями$value_field1 = "0"; // Мимими$sxml = simplexml_load_file ($file); $count=count($sxml); // Считаем количество записей$delete = $_GET['delete'];if($delete !== NULL){		if (isset($_COOKIE['CartItem'])) {		    foreach ($_COOKIE['CartItem'] as $name => $value) {			$value = explode("and", $value);			if($value[0] == $delete){			setcookie("CartItem[".$name."]","");}				    }		}	header("Refresh:0; URL=/?cart");}function setcookies() {	$cartid = $_POST['id'];	$cartidcount = $_POST['quantity'];	$update = $_POST['update'];	$addnew = $_POST['addnew'];	if ($cartid !== NULL) {	$number = count($_COOKIE["CartItem"]) + 1;	if($addnew == "1"){		if (isset($_COOKIE['CartItem'])) {		    foreach ($_COOKIE['CartItem'] as $name => $value) {			$value = explode("and", $value);			if($value[0] == $cartid){			$cartidcount = $value[1] + $cartidcount;			$number = $name;			}				    }		}			$cookievalue = $cartid."and".$cartidcount;			setcookie("CartItem[".$number."]", $cookievalue, time()+60*60*24*30);	}		if($update == "1"){		if (isset($_COOKIE['CartItem'])) {		    foreach ($_COOKIE['CartItem'] as $name => $value) {			$value = explode("and", $value);			if($value[0] == $cartid){			$cookievalue = $cartid."and".$cartidcount;			setcookie ("CartItem[".$name."]", $cookievalue, time()+60*60*24*30);			}				    }		}	}		header("Refresh: 0;");	}}function delcookies() {$cartdelid = $_POST['delid'];	if ($cartdelid !== NULL) {setcookie("CartItem[".$cartdelid."]","");header("Refresh: 0;");}}function delALLcookies() {$delall = $_POST['delallcookies'];	if ($delall !== NULL) {if (isset($_COOKIE["CartItem"])) {	foreach ($_COOKIE["CartItem"] as $nick => $key){	setcookie("CartItem[".$nick."]","");	}}header("Refresh: 0;");}}setcookies();delcookies();delALLcookies();?><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Jazzed store</title><style>body {	margin:0;	padding:0;	background: #FFFFFF;	}#leftside ul li {	#background: none;	font: normal 13px/24px Arial, Helvetica, sans-serif;	background: url(/pics/cat-a.png) left 9px no-repeat;	margin: 0 0 0 0px;	padding: 0px 0 0px 13px;	vertical-align: top;	overflow: hidden;	color: #808182;}#leftside a {	color: #808182;}#leftside a:hover {	color: #13C6D4;}#leftside ul li .level2 {	padding: 0px 0 0px 14px;	margin: 0 0 0 0;	background: url(/pics/cat-a.png1) left 9px no-repeat;}#leftside ul .level2ul {	padding: 0px 0px 0px 0px;	margin: 0 0 0 0;}#leftside #title {	color: #404040;	letter-spacing: 0;	font: bold 13px/32px Arial, Helvetica, sans-serif;	text-transform: uppercase;	text-shadow: 0 0 5px #E6E6E6;	padding: 10px 0 0px 40px;	margin-bottom:-20px;}#logo {	margin-top:20px;	width:194px;	height:60px;	text-indent:-9999px;	background: url(/pics/Logo.png) no-repeat;	float:left;}#container {	margin: 10px auto;	width:960px;	background:#FFFFFF;	}#leftside {	float:right;	width:230px;	}#sidebanner-1 {	background: #f1f1f1;	width:230px;	height: 160px;	border:2px solid #f1f1f1;		}#sidebanner-2 {	margin-top:7px;	background: #f1f1f1;	width:230px;	height: 160px;	border:2px solid #f1f1f1;	}#mainbanner {	background: #f1f1f1;	width:720px;	height: 330px;	border:2px solid #f1f1f1;}#main {	float:left;	width: 720px;	}#head {	margin: 0px auto;	width:100%;	height: 120px;	background: url(pics/body.gif);	}#header {	margin: 0px auto;	width:960px;	padding: 10px;}#hdrstripe {	width:100%;	margin:0px auto;	height:46px;	background: url(/pics/Line2.png) repeat-x;}#menu {	width:960px;	margin:0px auto;	background:transparent;	font: normal 18px Arial, Helvetica, sans-serif;	color:#505050;	}#menu #itemz {	margin-top:10px;	margin-left:20px;	float:left;	background:transparent;	}#menu #slash {	float:left;	height:41px;	margin-left:20px;	border-left:1px solid #C9C9C9;	}#products {	margin-top: 10px;	background: #FFFFFF;}#products #desc {margin-top:5px;color: black;font: bold 15px Arial, Helvetica, sans-serif;}#products #price {	border-top: 1px dotted grey;	color: #13C6D4;	font: normal 18px Arial, Helvetica, sans-serif;	padding:5px;}#item {	margin-bottom:10px;	float:left;	width:230px;	overflow:hidden;	background: #f5f5f5;	margin-right:10px;	}#singleitem {	background: #FFFFFF;	padding:30px;	}#singleitemleft {float:left;width:320px;}#singleitemright {width:310px;float:right;}#singleitemprice {	border-top: 1px solid #f1f1f1;	border-bottom: 1px solid #f1f1f1;	color: #13C6D4;	font: normal 28px/28px Arial, Helvetica, sans-serif;	padding:10px;}#singleitemtitle {color: #505050;font: normal 18px/20px Arial, Helvetica, sans-serif;padding:10px;}#singleitemdesc {	border-bottom:1px solid #f1f1f1;	color: #AEADAD;	font: normal 12px/17px Arial, Helvetica, sans-serif;	padding:10px;}#inside_item {	padding: 10px;}#singlepage {	width: 700px;	border: 1px solid #f1f1f1;	width: 100%;}#cart {	float:right;		}#cartitem {	width: 100%;	height:50px;	padding:0px;	border:1px solid #ebebeb;	margin-bottom:10px;}#cartitem .number {	float:left;	border-right:1px solid #ebebeb;	height:20px;	padding:15px;	width:10px;	}#cartitem .title {	float:left;	border-right:1px solid #ebebeb;	height:20px;	width:170px;	padding:15px;}#cartitem .price {	float:left;	border-right:1px solid #ebebeb;	height:20px;	width:120px;	padding:15px;}#cartitem .delete {	float:left;	border-right:0px solid #ebebeb;	height:30px;	width:180px;	padding:10px;}#cartitem .delete #input {	float:left;	padding-left:25px;}#cartitem .delete #button {	float:right;	margin-top:-1px;	padding-right:25px;	background:#FFFFFF;}#cartitem #deletelink {	margin-left:25px;	height:6px;	padding:0px;	margin-top:-18px;	color: #505050;	font: normal 10px Arial, Helvetica, sans-serif;	text-decoration:none;}#cartitem #deletelink a{	color: #505050;	font: normal 10px Arial, Helvetica, sans-serif;	text-decoration:none;}#cartitem .itog {	height:20px;	float:right;	border-left:1px solid #ebebeb;	padding:15px;	width:80px;}#cartitem p {	margin:0px auto !important;}#singleitempic {padding:10px;	border: 1px solid #f1f1f1;}</style></head><body>	<div id="head">		<div id="header">	<a href="/"><div id="logo" >Jazzed store</div></a>		<div id="cart">		<?php echo "<a href=\"/?cart\">Корзина</a>: ".count($_COOKIE['CartItem'])." Товаров<br/>"; ?><form method="POST" action="/" name="cart">	<input type="hidden" name="delallcookies" value="blalba" >	<input type="submit" name="cart" value="Очистить корзину">	</form>		</div>		</div>	</div>		<div id="hdrstripe">	<div id="menu">	<div id="itemz">Главная</div>	<div id="slash"></div>	<div id="itemz">Каталог</div>	<div id="slash"></div>	<div id="itemz">Услуги</div>	<div id="slash"></div>	<div id="itemz">О нас</div>	</div>		</div>    <div id="container">	<div id="leftside">		<?php if ($_SERVER['REQUEST_URI'] == "/" ){echo "<div id=\"sidebanner-1\" ><img src=\"/banners/side0.jpg\"></div><div id=\"sidebanner-2\" ><img src=\"/banners/side1.jpg\"></div> ";}?>	<div id="title">Категории</div>	<ul>	<li><a href="/?cat=e-book">Электронные книги</a>		<ul class="level2ul">		<li class="level2"><a href="/?cat=e-book">Kindle</a></li>		<li class="level2"><a href="/?cat=e-book">Nook</a></li>		<li class="level2"><a href="/?cat=e-book">Sony</a></li>		<li class="level2"><a href="/?cat=e-book">PocketBook</a></li>		<li class="level2"><a href="/?cat=e-book">Аксессуары</a></li>		</ul>	</li>	<li><a href="/?cat=electronics/">Электроника</a>	</li>	<li><a href="/?cat=apple">Продукция Apple</a>		<ul class="level2ul">		<li class="level2"><a href="/?cat=apple">iPhone</a></li>		<li class="level2"><a href="/?cat=apple">iPad</a></li>		<li class="level2"><a href="/?cat=apple">iMac</a></li>		<li class="level2"><a href="/?cat=apple">MacBook</a></li>		</ul>	</li>	<li><a href="/?cat=clothes/">Одежда и обувь</a>		<ul class="level2ul">		<li class="level2"><a href="/?cat=clothes/m">Мужская</a></li>		<li class="level2"><a href="/?cat=clothes/w">Женская</a></li>		<li class="level2"><a href="/?cat=clothes/kids">Детская</a></li>		</ul>	</li>	<li><a href="/?cat=accesories">Аксессуары</a></li>	<li><a href="/?cat=gifts">Подарки</a></li>	</ul>	</div>	<div id="main">	<?php if ($_SERVER['REQUEST_URI'] == "/" ){echo "<div id=\"mainbanner\" ><img src=\"/banners/baner_top.jpg\"></div>";}?>	<div id="products">	<?php// debug info/*if (isset($_COOKIE['CartItem'])) {    foreach ($_COOKIE['CartItem'] as $name => $value) {        $name = htmlspecialchars($name);        $value = htmlspecialchars($value);        echo $name." : ".$value." <br />";    }}*/function products(){$path = "/home/p42363/www/store.jazzed.ru/"; // Путь к главной директории$httppath = "http://store.jazzed.ru/";$file = $path ."database/products.xml"; // Файл с новостями$value_field1 = "0"; // Мимими$sxml = simplexml_load_file ($file); $count=count($sxml); // Считаем количество записей$reader = new XMLReader();$reader->open($file);while ($reader->read()) {   switch ($reader->nodeType) {       case (XMLREADER::ELEMENT):       if ($reader->localName == "item") {for ($i = $count-1;$i > -1 ;$i-- ){		// 1: Проверяем есть ли наш продукт в базе и изменилось ли количествозаписей для него (lastcount)          if ($reader->getAttribute("id") == $i) //&& $reader->getAttribute("title") == "Kindle Fire" {  						$id = $reader->getAttribute("id"); // Берем ID записи с нашим треком		$cat = $reader->getAttribute("cat");		$title = $reader->getAttribute("title");		$desc = $reader->getAttribute("desc");		$photo = $reader->getAttribute("photo");		$price = $reader->getAttribute("price");		$stock = $reader->getAttribute("stock");echo "  <div id=\"item\">	<div id=\"inside_item\">	<div><a href=\"/?item=".$id."\"><img width=210 height=200 src=".$photo." /></a></div>	<div id=\"desc\">".$title."</div>	<div id=\"price\">".$price." руб.</div>	</div></div>";}}	                  }   }}}function products_category($cat){$path = "/home/p42363/www/store.jazzed.ru/"; // Путь к главной директории$httppath = "http://store.jazzed.ru/";$file = $path ."database/products.xml"; // Файл с новостями$value_field1 = "0"; // Мимими$sxml = simplexml_load_file ($file); $count=count($sxml); // Считаем количество записей$reader = new XMLReader();$reader->open($file);while ($reader->read()) {   switch ($reader->nodeType) {       case (XMLREADER::ELEMENT):       if ($reader->localName == "item") {for ($i = $count-1;$i > -1 ;$i-- ){		// 1: Проверяем есть ли наш продукт в базе и изменилось ли количествозаписей для него (lastcount)          if ( $reader->getAttribute("id") == $i && $reader->getAttribute("cat") == $cat || $reader->getAttribute("subcat") == $cat) //&& $reader->getAttribute("title") == "Kindle Fire" {  						$id = $reader->getAttribute("id"); // Берем ID записи с нашим треком		$cat = $reader->getAttribute("cat");		$title = $reader->getAttribute("title");		$desc = $reader->getAttribute("desc");		$photo = $reader->getAttribute("photo");		$price = $reader->getAttribute("price");		$stock = $reader->getAttribute("stock");echo "  <div id=\"item\">	<div id=\"inside_item\">	<div><a href=\"/?item=".$id."\"><img width=210 height=200 src=".$photo." /></a></div>	<div id=\"desc\">".$title."</div>	<div id=\"price\">".$price." руб.</div>	</div></div>";}}	                  }   }}if($id == NULL){echo "В данной категории нет товаров.";}}function single_product($itemid){$path = "/home/p42363/www/store.jazzed.ru/"; // Путь к главной директории$httppath = "http://store.jazzed.ru/";$file = $path ."database/products.xml"; // Файл с новостями$value_field1 = "0"; // Мимими$sxml = simplexml_load_file ($file); $count=count($sxml); // Считаем количество записей$reader = new XMLReader();$reader->open($file);while ($reader->read()) {   switch ($reader->nodeType) {       case (XMLREADER::ELEMENT):       if ($reader->localName == "item") {		// 1: Проверяем есть ли наш продукт в базе и изменилось ли количествозаписей для него (lastcount)          if ($reader->getAttribute("id") == $itemid) //&& $reader->getAttribute("title") == "Kindle Fire" {  						$id = $reader->getAttribute("id"); // Берем ID записи с нашим треком		$cat = $reader->getAttribute("cat");		$title = $reader->getAttribute("title");		$desc = $reader->getAttribute("desc");		$photo = $reader->getAttribute("photo");		$price = $reader->getAttribute("price");		$stock = $reader->getAttribute("stock");echo "  <div id=\"singlepage\">	<div id=\"singleitem\">	<div id=\"singleitemleft\">		<div id=\"singleitempic\"><img width=300 height=300 src=".$photo." /></div>	</div>	<div id=\"singleitemright\">	<div id=\"singleitemtitle\">".$title."</div>		<div id=\"singleitemprice\">".$price." руб.</div>	<div id=\"singleitemdesc\">".$desc."</div>	<form method=\"POST\" action=\"/?cart\" name=\"cart\">	<input type=\"hidden\" name=\"id\" value=".$id." >	<input type=\"hidden\" name=\"addnew\" value=\"1\" >	<input type=\"text\" name=\"quantity\" size=\"1\" value=\"1\" >	<input type=\"submit\" name=\"cart\" value=\"To Cart\">	</form>	</div>	<div style=\"clear:both;\"></div></div></div>";}}	                  }   }}function cart() {echo "<div id=\"cartitem\">";echo "<div class=\"number\" >ID</div>";echo "<div class=\"title\">Наименование</div>";echo "<div class=\"price\">Цена за единицу</div>";echo "<div class=\"delete\">Количество</div>";echo "<div class=\"itog\" ><p>Итого</p></div></div><div style=\"clear:both\";></div>";$path = "/home/p42363/www/store.jazzed.ru/"; // Путь к главной директории$httppath = "http://store.jazzed.ru/";$file = $path ."database/products.xml"; // Файл с новостями$value_field1 = "0"; // Мимими$sxml = simplexml_load_file ($file); $count=count($sxml); // Считаем количество записейif (isset($_COOKIE['CartItem'])) {    foreach ($_COOKIE['CartItem'] as $name => $value) {        $value = explode("and", $value);	$productid = $value[0];        $quantity = $value[1];$reader = new XMLReader();$reader->open($file);while ($reader->read()) {   switch ($reader->nodeType) {       case (XMLREADER::ELEMENT):       if ($reader->localName == "item") {		// 1: Проверяем есть ли наш продукт в базе и изменилось ли количествозаписей для него (lastcount)          if ($reader->getAttribute("id") == $productid) //&& $reader->getAttribute("title") == "Kindle Fire" 		{  						$id = $reader->getAttribute("id"); // Берем ID записи с нашим треком		$cat = $reader->getAttribute("cat");		$title = $reader->getAttribute("title");		$desc = $reader->getAttribute("desc");		$photo = $reader->getAttribute("photo");		$price = $reader->getAttribute("price");		$stock = $reader->getAttribute("stock");		$itogo = $quantity*$price;echo "<div id=\"cartitem\">";echo "<div class=\"number\">". $productid ."</div>";echo "<div class=\"title\">". $title ."</div>";echo "<div class=\"price\">". $price ." руб.</div>";echo "<div class=\"delete\"><form method=\"POST\" action=\"/?cart\" name=\"cart\">	<input type=\"hidden\" name=\"id\" value=".$productid." >	<input type=\"hidden\" name=\"update\" value=\"1\" >	<div id=\"input\"><input type=\"text\" name=\"quantity\" size=\"1\" value=".$quantity." ></div>	<div id=\"button\"><input type=\"submit\" name=\"cart\" value=\"Обновить\"></div><div style=\"clear:both\";></div>	</form><div id=\"deletelink\"><a href=\"?delete=".$productid."\">Удалить</a></div></div>	<div class=\"itog\">".$itogo." руб.</div>	</div>	<div style=\"clear:both\";></div>	";$full = $full+$itogo;		}	} 	} }							}					}echo "<div style=\"float:right;border:1px solid #F1f1f1;width:80px;padding:15px;\">".$full." руб.</div>";}$page = $_GET['cart'];$category = $_GET['cat'];$item = $_GET['item'];if ($page !== NULL){echo "Корзина<br/>";cart();}elseif($item !== NULL){single_product($item);}elseif($category !== NULL){products_category($category);}else{products();}?>	</div>	</div>	</div></body></html>